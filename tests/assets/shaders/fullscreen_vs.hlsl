//----------------------------------------------------------------------------
//! @file   fullscreen_vs.hlsl
//! @brief  フルスクリーン三角形用頂点シェーダー（テスト用）
//!
//! @details
//! このシェーダーは以下をテストします：
//! - SV_VertexIDセマンティクスの使用
//! - 頂点バッファなしでの描画
//! - ビット演算によるUV座標生成
//!
//! 使用例：ポストプロセス、フルスクリーンエフェクト
//! 呼び出し方：Draw(3, 0) で頂点バッファをバインドせずに実行
//!
//! 生成される三角形：
//!   頂点0: (-1, -1) UV(0, 0) - 左下
//!   頂点1: ( 3, -1) UV(2, 0) - 右外側
//!   頂点2: (-1,  3) UV(0, 2) - 上外側
//! この大きな三角形がビューポート全体をカバーする
//----------------------------------------------------------------------------

//! 頂点シェーダー出力構造体
struct VSOutput
{
    float4 position : SV_POSITION;  //!< クリップ空間座標
    float2 texCoord : TEXCOORD0;    //!< テクスチャ座標（0-1でビューポートをカバー）
};

//! フルスクリーン三角形を生成する頂点シェーダー
//! @param [in] vertexId システムが提供する頂点インデックス（0, 1, 2）
//! @return ピクセルシェーダーへの出力
//!
//! @note 頂点バッファ不要で3頂点のフルスクリーン三角形を生成
//!       2つの三角形を使用するクワッドより効率的
VSOutput VSMain(uint vertexId : SV_VertexID)
{
    VSOutput output;

    // ビット演算でテクスチャ座標を生成
    // vertexId=0: (0,0), vertexId=1: (2,0), vertexId=2: (0,2)
    output.texCoord = float2((vertexId << 1) & 2, vertexId & 2);

    // テクスチャ座標からクリップ空間座標を計算
    // UV(0,0) -> Pos(-1,1), UV(1,1) -> Pos(1,-1)
    output.position = float4(output.texCoord * float2(2.0, -2.0) + float2(-1.0, 1.0), 0.0, 1.0);

    return output;
}
