# RHI（Render Hardware Interface）設計原則

グラフィックスAPI（DirectX 12、Vulkan等）の抽象化レイヤー。

---



---

## 設計原則

抽象化

API非依存（DX12/Vulkan/Metal差異の隠蔽）
機能クエリで拡張対応

リソース管理

明示的なライフタイム管理
遅延削除（GPU使用中は解放しない）
メモリエイリアシング

コマンド

記録と実行の分離
ステートレスな設計
マルチスレッド記録対応

同期

明示的なフェンス/バリア
リソース状態遷移の明示化

パイプライン

PSO事前生成・キャッシュ
記述子セットを更新頻度で分離

デバッグ

バリデーションレイヤー
デバッグ名/マーカー

拡張性

構造体バージョニング
ネイティブAPIへのエスケープハッチ

---

## 禁止事項

| 禁止 | 理由 | 代替 |
|------|------|------|
| Public APIでのD3D12/Vulkan型 | 移植性喪失 | 抽象インターフェース |
| 生ポインタでのリソース所有 | リーク | スマートポインタ、RAII |
| 暗黙の状態変更 | デバッグ困難 | 明示的API |
| 例外 | パフォーマンス | `NS::Result` |
| グローバルデバイス | テスト困難 | 依存性注入 |
