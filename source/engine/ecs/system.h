//----------------------------------------------------------------------------
//! @file   system.h
//! @brief  ECS System基底クラス
//----------------------------------------------------------------------------
#pragma once

namespace ECS {

// 前方宣言
class World;

//============================================================================
//! @brief 更新システムの基底クラス
//!
//! 全てのECS更新システムはこれを継承する。
//! finalクラスとして実装し、LTOで仮想関数をインライン化可能にする。
//============================================================================
class ISystem {
public:
    virtual ~ISystem() = default;

    //------------------------------------------------------------------------
    //! @brief システム実行
    //! @param world ワールド参照
    //! @param dt 固定デルタタイム
    //------------------------------------------------------------------------
    virtual void Execute(World& world, float dt) = 0;

    //------------------------------------------------------------------------
    //! @brief 優先度取得（小さいほど先に実行）
    //! @return 優先度
    //------------------------------------------------------------------------
    virtual int Priority() const { return 0; }

    //------------------------------------------------------------------------
    //! @brief システム名取得（デバッグ用）
    //! @return システム名
    //------------------------------------------------------------------------
    virtual const char* Name() const { return "ISystem"; }
};

//============================================================================
//! @brief 描画システムの基底クラス
//!
//! 全てのECS描画システムはこれを継承する。
//! finalクラスとして実装し、LTOで仮想関数をインライン化可能にする。
//============================================================================
class IRenderSystem {
public:
    virtual ~IRenderSystem() = default;

    //------------------------------------------------------------------------
    //! @brief 描画実行
    //! @param world ワールド参照
    //! @param alpha 補間係数（0.0〜1.0）
    //------------------------------------------------------------------------
    virtual void Render(World& world, float alpha) = 0;

    //------------------------------------------------------------------------
    //! @brief 優先度取得（小さいほど先に実行）
    //! @return 優先度
    //------------------------------------------------------------------------
    virtual int Priority() const { return 0; }

    //------------------------------------------------------------------------
    //! @brief システム名取得（デバッグ用）
    //! @return システム名
    //------------------------------------------------------------------------
    virtual const char* Name() const { return "IRenderSystem"; }
};

} // namespace ECS
